#!/usr/bin/env python

"""Generate a tagged (sender-style) e-mail address.

Usage:  %(program)s [-c <file>] [-h] address

Where:
	-c <file>
	--config-file <file>
	   Specify a different configuration file other than ~/.tmdarc.

	--help
	-h
	   Print this help message and exit.
"""

import getopt
import os
import sys


program = sys.argv[0]

def usage(code, msg=''):
    print __doc__ % globals()
    if msg:
        print msg
    sys.exit(code)

try:
    opts, args = getopt.getopt(sys.argv[1:],
                                   'c:h', ['config-file=','help'])
except getopt.error, msg:
    usage(1, msg)

if len(args) <> 1:
    usage(1)

for opt, arg in opts:
    if opt in ('-h', '--help'):
        usage(0)
    elif opt in ('-c', '--config-file'):
        os.environ['TMDARC'] = arg


import paths
from TMDA import Cookie


def main():

    address = sys.argv[1]
    sender_address = Cookie.make_sender_address(address)
    sys.stdout.write(sender_address)


if __name__ == '__main__':
    main()
