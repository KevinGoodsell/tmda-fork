<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<?xml-stylesheet href="display/styles.css" type="text/css"?>
<html>
<!-- THIS PAGE IS AUTOMATICALLY GENERATED.  DO NOT EDIT. -->
<!-- Mon Aug 11 12:43:25 2003 -->
<!-- USING HT2HTML 2.1 -->
<!-- SEE http://ht2html.sf.net -->
<!-- User-specified headers:
Title: Auto-installation & Auto-uninstallation

-->

<head>
<title>Auto-installation & Auto-uninstallation</title>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<meta name="generator" content="HT2HTML/2.1">
<link rel="STYLESHEET" href="display/styles.css" type="text/css">
</head>
<body bgcolor="#A6A6B3" text="#000000"
      onload="Preloader()"
      link="#0000bb"  vlink="#551a8b"
      alink="#ff0000">
<!-- start of page table -->
<table bgcolor="#FFFFFF" width="700" height="100%" border="0"
cellspacing="0" cellpadding="0"><tr><td valign="top"><table class="matte"
width="100%" height="100%" border="0" cellspacing="0" cellpadding="0"><tr>
<td valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0">
<!-- start of banner row -->
<tr>
<!-- start of corner cells -->
<td width="194" height="135" valign="middle" bgcolor="#7B7CB6" class="corner"><img src="display/corner.gif" width="194" height="135" alt=""></td>
<!-- end of corner cells -->
<!-- start of banner -->
<td height="135" valign="top" background="display/top_bg.gif" bgcolor="#7B7CB6" class="banner"><a href="/"><img src="display/title.png" width="341" height="135"
border="0" alt="TMDA (http://tmda.net) CGI Interface"></a></td><!-- end of banner -->
</tr><!-- end of banner row -->
<tr><!-- start of sidebar/body row -->
<!-- start of sidebar cells -->
<td width="194" background="display/left_bg.gif" bgcolor="#7B7CB6" valign="top" class="sidebar">
<!-- start of sidebar table -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><a href="index.html"
onmouseover="document.images.x37.src='display/dyn_buttons/layout1_r1_c1_h.png'"
onmouseout="document.images.x37.src='display/dyn_buttons/layout1_r1_c1.png'"><img
src="display/dyn_buttons/layout1_r1_c1.png" name="x37" height="50" width="194" border="0" alt="Overview"></a></td></tr>
<tr><td><a href="t_index.html"
onmouseover="document.images.x115.src='display/dyn_buttons/layout1_r2_c1_h.png'"
onmouseout="document.images.x115.src='display/dyn_buttons/layout1_r2_c1.png'"><img
src="display/dyn_buttons/layout1_r2_c1.png" name="x115" height="35" width="194" border="0" alt="Tutorial"></a></td></tr>
<tr><td><a href="virtual.html"
onmouseover="document.images.x195.src='display/dyn_buttons/layout1_r3_c1_h.png'"
onmouseout="document.images.x195.src='display/dyn_buttons/layout1_r3_c1.png'"><img
src="display/dyn_buttons/layout1_r3_c1.png" name="x195" height="35" width="194" border="0" alt="Virtual Users"></a></td></tr>
<tr><td><a href="download.html"
onmouseover="document.images.x275.src='display/dyn_buttons/layout1_r4_c1_h.png'"
onmouseout="document.images.x275.src='display/dyn_buttons/layout1_r4_c1.png'"><img
src="display/dyn_buttons/layout1_r4_c1.png" name="x275" height="35" width="194" border="0" alt="Install"></a></td></tr>
<tr><td><a href="auth.html"
onmouseover="document.images.x355.src='display/dyn_buttons/layout1_r5_c1_h.png'"
onmouseout="document.images.x355.src='display/dyn_buttons/layout1_r5_c1.png'"><img
src="display/dyn_buttons/layout1_r5_c1.png" name="x355" height="35" width="194" border="0" alt="Passwords"></a></td></tr>
<tr><td><img src="display/dyn_buttons/layout1_r6_c1_h.png"
height="35" width="194" border="0" alt="Config."></td></tr>
<tr><td><a href="config.html" onmouseover="document.images.subtopic15.src='display/dyn_buttons/h-subtopic15.png'"
onmouseout="document.images.subtopic15.src='display/dyn_buttons/subtopic15.png'"><img src="display/dyn_buttons/subtopic15.png" border="0" alt=" - Configuration" width="194" height="14"
name="subtopic15"></a></td></tr>
<tr><td><a href="tmdaconfig.html" onmouseover="document.images.subtopic16.src='display/dyn_buttons/h-subtopic16.png'"
onmouseout="document.images.subtopic16.src='display/dyn_buttons/subtopic16.png'"><img src="display/dyn_buttons/subtopic16.png" border="0" alt=" -    TMDA config" width="194" height="14"
name="subtopic16"></a></td></tr>
<tr><td><a href="defaults.html" onmouseover="document.images.subtopic17.src='display/dyn_buttons/h-subtopic17.png'"
onmouseout="document.images.subtopic17.src='display/dyn_buttons/subtopic17.png'"><img src="display/dyn_buttons/subtopic17.png" border="0" alt=" -    defaults.ini" width="194" height="14"
name="subtopic17"></a></td></tr>
<tr><td><a href="themeini.html" onmouseover="document.images.subtopic18.src='display/dyn_buttons/h-subtopic18.png'"
onmouseout="document.images.subtopic18.src='display/dyn_buttons/subtopic18.png'"><img src="display/dyn_buttons/subtopic18.png" border="0" alt=" -    theme.ini" width="194" height="14"
name="subtopic18"></a></td></tr>
<tr><td><a href="userprefs.html" onmouseover="document.images.subtopic19.src='display/dyn_buttons/h-subtopic19.png'"
onmouseout="document.images.subtopic19.src='display/dyn_buttons/subtopic19.png'"><img src="display/dyn_buttons/subtopic19.png" border="0" alt=" -    User prefs." width="194" height="14"
name="subtopic19"></a></td></tr>
<tr><td><img src="display/dyn_buttons/h-subtopic20.png" border="0" alt=" - Auto-installation" width="194" height="14"
name="subtopic20"></td></tr>
<tr><td><a href="confirm.html" onmouseover="document.images.subtopic21.src='display/dyn_buttons/h-subtopic21.png'"
onmouseout="document.images.subtopic21.src='display/dyn_buttons/subtopic21.png'"><img src="display/dyn_buttons/subtopic21.png" border="0" alt=" - URL Confirmation" width="194" height="14"
name="subtopic21"></a></td></tr>
<tr><td><a href="custom.html" onmouseover="document.images.subtopic22.src='display/dyn_buttons/h-subtopic22.png'"
onmouseout="document.images.subtopic22.src='display/dyn_buttons/subtopic22.png'"><img src="display/dyn_buttons/subtopic22.png" border="0" alt=" - Customization" width="194" height="14"
name="subtopic22"></a></td></tr>
<tr><td><a href="surprise.html"
onmouseover="document.images.x1044.src='display/dyn_buttons/layout1_r7_c1_h.png'"
onmouseout="document.images.x1044.src='display/dyn_buttons/layout1_r7_c1.png'"><img
src="display/dyn_buttons/layout1_r7_c1.png" name="x1044" height="35" width="194" border="0" alt="Support"></a></td></tr>
</table><!-- end of sidebar table -->

</td>
<!-- end of sidebar cell -->
<!-- start of body cell -->
<td valign="top" class="body"><h2>Auto-install</h2>

<p>tmda-cgi is now capable of autoinstalling TMDA on user accounts.</p>

<p><b><i>TMDA must already be installed on the server.</i></b></p>

<p>This feature does not install TMDA, but configures an already existing
  e-mail account so it will work with TMDA.</p>

<p>To use this feature, the user need only log in to tmda-cgi (<a
  href="auth.html#ProgAuth">program</a> or <a
  href="auth.html#RemtAuth">remote</a> authentication is strongly recommended
  if you wish to use auto-install) and click "Sign up." However, the system
  administrator will need to verify how the installation will be done
  beforehand!</p>

<a href="#Skel"><tt>skel</tt></a><br>
<a href="#Anomalies"><tt>anomalies</tt></a><br>
&nbsp;&nbsp;&nbsp;<a href="#PERMISSIONS"><tt>PERMISSIONS</tt></a><br>
&nbsp;&nbsp;&nbsp;<a href="#VIRTUAL_TEST"><tt>VIRTUAL_TEST</tt></a><br>
&nbsp;&nbsp;&nbsp;<a href="#REAL_ONLY"><tt>REAL_ONLY</tt></a><br>
&nbsp;&nbsp;&nbsp;<a href="#VIRTUAL_ONLY"><tt>VIRTUAL_ONLY</tt></a><br>
&nbsp;&nbsp;&nbsp;<a href="#PARENT_RE"><tt>PARENT_RE</tt></a><p>

<h3><a name="Skel"></a><tt>skel</tt></h3>

<p>Before allowing users to auto-install or auto-uninstall, carefully check
  over each file in the <tt>skel/install</tt> directory. These files will be
  copied to the user's directory upon installation.</p>

<p><b><i>Important note:</i></b> The <tt>skel</tt> directories included with
  tmda-cgi were designed for servers running <a
  href="http://cr.yp.to/qmail.html">qmail</a>.  If you use a different mail
  server package, do <b><i>not</i></b> use the files as-is! You should look
  through these files and see how they work, but you will need to create a
  totally different set of <tt>skel</tt> files.

<p><tt>skel</tt> files allow for variable substitution. All of the following
  text strings, if found in the file or filename, will be replaced with the
  following:</p>

<table cellpadding="7">
  <tr>
    <td valign="top" nowrap><b><tt>%(Base)s</tt></b></td>
    <td>The path to TMDA's root directory.</td>
  </tr>
  <tr>
    <td valign="top" nowrap><b><tt>%(CryptKey)s</tt></b></td>
    <td>A new valid, random, cryptographic key.</td>
  </tr>
  <tr>
    <td valign="top" nowrap><b><tt>%(Domain)s</tt></b></td>
    <td>Best guess of the user's domain.</td>
  </tr>
  <tr>
    <td valign="top" nowrap><b><tt>%(Home)s</tt></b></td>
    <td>The path to the user's home directory.</td>
  </tr>
  <tr>
    <td valign="top" nowrap><b><tt>%(Name)s</tt></b></td>
    <td>A quoted string or None, depending on whether user's real name is
      available.</td>
  </tr>
  <tr>
    <td valign="top" nowrap><b><tt>%(Parent)s</tt></b></td>
    <td>The constant string "<tt>..</tt>".</td>
  </tr>
  <tr>
    <td valign="top" nowrap><b><tt>%(qUser)s</tt></b></td>
    <td>Same as <tt>%(qUser)s</tt> below, except that any "." characters have
      been replaced with ":" characters.  .qmail files require user names to be
      renamed in this fashion.</td>
  </tr>
  <tr>
    <td valign="top" nowrap><b><tt>%(RealHome)s</tt></b></td>
    <td>The home directory for the real user in use. If a real user is logging
      in, then this is their home directory. If a virtual user is logging in,
      then this is typically <tt>/home/vpopmail</tt>.</td>
  </tr>
  <tr>
    <td valign="top" nowrap><b><tt>%(ShortUrlDom)s</tt></b></td>
    <td>The domain name portion of the URL the user surfed up, without any
      "www.", if present.<br>
      Also see <tt>%(UrlDomain)s</tt>, below.</td>
  </tr>
  <tr>
    <td valign="top" nowrap><b><tt>%(UrlDomain)s</tt></b></td>
    <td>The domain name portion of the URL the user surfed up.<br>
      Also see <tt>%(ShortUrlDom)s</tt>, above.</td>
  </tr>
  <tr>
    <td valign="top" nowrap><b><tt>%(User)s</tt></b></td>
    <td>The user's login name, or the left-most portion (before the "@") of the
      user's e-mail address in the case of virtual users.</td>
  </tr>
  <tr>
    <td valign="top" nowrap><b><tt>%(VirtUser)d</tt></b></td>
    <td>1 if the user is a virtual user, 0 if the user is real.</td>
  </tr>
  <tr>
    <td valign="top" nowrap><b><tt>%(VPop)s</tt></b></td>
    <td>The path to the virtual user's home directory (for example:
      <tt>/home/vpopmail</tt>).</td>
  </tr>
  <tr>
    <td valign="top" nowrap><b><tt>%(VPopBin)s</tt></b></td>
    <td>The path to the virtual user's bin directory (for example:
      <tt>/home/vpopmail/bin</tt>).</td>
  </tr>
</table>

<p>If you need to put a "%" in one of the <tt>skel</tt> files, you will have to
  type "%%" instead.  This will prevent errors during the install process.</p>

<p>In addition to a <tt>skel/install</tt> directory, there is also a
  <tt>skel/uninstall</tt> directory.  If you have any files which should be
  installed after the uninstall process is complete, you may place skeletons
  for them files here. For example, qmail users should add a
  <tt>.qmail-default</tt> file after uninstallation so that any future mail
  that comes in for a tagged address will still be accepted.</p>

<h3><a name="Anomalies"></a><tt>anomalies</tt></h3>

<p><tt>skel</tt> directories may optionally have a file called
  <tt>anomalies</tt>. This file contains <a href="http://python.org">Python</a>
  code which tells the installer/uninstaller what it should do beyond simply
  copying the files to the user's directory.</p>

<p><tt>anomalies</tt> supports the following variables:</p>

<h4><a name="#PERMISSIONS"></a><tt>PERMISSIONS</tt></h4>
<blockquote>
  <p>A dictionary of filenames and what octal permissions should be assigned to
    them.</p>
  <p>Install example:
    <table class="example">
      <tr>
        <td>PERMISSIONS = {".tmda/crypt_key": 0600}</td>
      </tr>
    </table>
</blockquote>

<h4><a name="#VIRTUAL_TEST"></a><tt>VIRTUAL_TEST</tt></h4>
<blockquote>
  <p>A regular expression test which can be applied to a user's HOME directory.
    If the test matches, then the user is assumed to be a virtual user.</p>
  <p>Example:
    <table class="example">
      <tr>
        <td>VIRTUAL_TEST = "^" + VPop</td>
      </tr>
    </table>
</blockquote>

<h4><a name="#REAL_ONLY"></a><tt>REAL_ONLY</tt></h4>
<blockquote>
  <p>A list of files or a dictionary of lists which should only be copied if
    the user logging in is "real" (i.e. <a
    href="#VIRTUAL_TEST"><tt>VIRTUAL_TEST</tt></a> did not match the user's
    HOME directory).</p>
  <p>The optional dictionary structure of this configuration variable allows
    you to specify different files based on the mail program (see <tt><a
    href="/config-vars.html#MAIL_TRANSFER_AGENT">MAIL_TRANSFER_AGENT</a></tt>)
    you're using.  You can only have one mail program installed, of course, so
    if you are creating this skel directory by hand, feel free to simply use a
    list.</p>
  <p>Install example:
    <table class="example">
      <tr>
        <td>REAL_ONLY = {"qmail": [".qmail", ".qmail-default"]}</td>
      </tr>
    </table>
  <p>Uninstall example:
    <table class="example">
      <tr>
        <td>REAL_ONLY = {"qmail": [".qmail-default"]}</td>
      </tr>
    </table>
</blockquote>

<h4><a name="#VIRTUAL_ONLY"></a><tt>VIRTUAL_ONLY</tt></h4>
<blockquote>
  <p><tt>VIRTUAL_ONLY</tt> is the compliment to <a
    href="#REAL_ONLY"><tt>REAL_ONLY</tt></a>, above.  These files should only
    be copied if the user logging in is a virtual user (i.e. <a
    href="#VIRTUAL_TEST"><tt>VIRTUAL_TEST</tt></a> matched the user's HOME
    directory).</p>
  <p>Install example:
    <table class="example">
      <tr>
        <td>VIRTUAL_ONLY = {"qmail": ["%(Parent)s/.qmail-%(User)s",<br>
          &nbsp;&nbsp;"%(Parent)s/.qmail-%(User)s-default"]}</td>
      </tr>
    </table>
  <p>Uninstall example:
    <table class="example">
      <tr>
        <td>VIRTUAL_ONLY = {"qmail":
          ["%(Parent)s/.qmail-%(User)s-default"]}</td>
      </tr>
    </table>
</blockquote>

<h4><a name="#PARENT_RE"></a><tt>PARENT_RE</tt></h4>
<blockquote>
  <p><tt>PARENT_RE</tt> is a regular expression which tests if we are in the
    user's "parent" directory.  Finding the parent directory is not as simple
    as doing a ".." because virtual user systems with many users may stack the
    domain multiple layers down.  By using this test we can tell when we have
    removed enough directories.</p>
  <p>Example:
    <table class="example">
      <tr>
        <td>PARENT_RE = "^" + VPop + "/domains/[^/]+\.[^/]+$"</td>
      </tr>
    </table>
</blockquote>
</td>
<!-- end of body cell -->
</tr><!-- end of sidebar/body row -->
</table></td></tr></table></td></tr></table><!-- end of page table -->
<script>
<!--
function Preloader()
{
  var x37 = new Image();
x37.src = "display/dyn_buttons/layout1_r1_c1_h.png";
  var x115 = new Image();
x115.src = "display/dyn_buttons/layout1_r2_c1_h.png";
  var x195 = new Image();
x195.src = "display/dyn_buttons/layout1_r3_c1_h.png";
  var x275 = new Image();
x275.src = "display/dyn_buttons/layout1_r4_c1_h.png";
  var x355 = new Image();
x355.src = "display/dyn_buttons/layout1_r5_c1_h.png";
var subtopic15 = new Image();
subtopic15.src = "display/dyn_buttons/h-subtopic15.png";
var subtopic16 = new Image();
subtopic16.src = "display/dyn_buttons/h-subtopic16.png";
var subtopic17 = new Image();
subtopic17.src = "display/dyn_buttons/h-subtopic17.png";
var subtopic18 = new Image();
subtopic18.src = "display/dyn_buttons/h-subtopic18.png";
var subtopic19 = new Image();
subtopic19.src = "display/dyn_buttons/h-subtopic19.png";
var subtopic21 = new Image();
subtopic21.src = "display/dyn_buttons/h-subtopic21.png";
var subtopic22 = new Image();
subtopic22.src = "display/dyn_buttons/h-subtopic22.png";
  var x1044 = new Image();
x1044.src = "display/dyn_buttons/layout1_r7_c1_h.png";
}
//-->
</script>
</body></html>
